
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <canvas id="fireworks" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 32767"></canvas>
    <script src="https://cdn.staticfile.org/animejs/3.2.1/anime.min.js"></script>
    <script src="/js/<file>"></script>
    <link rel="stylesheet" href="/css/<file>" />
    <script src="/js/fireworks.min.js"></script>
    <canvas id="background" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: -1"></canvas>
    <script src="/js/background.min.js"></script>
    <div id="cursor"></div>
    <link rel="stylesheet" href="/css/cursor.min.css">
    <script src="/js/cursor.min.js"></script>
    <meta charset="utf-8" />
    <title>冰蝎、哥斯拉、蚁剑、菜刀流量特征分析 | OvO</title>
    <meta name="author" content="你猜不到的" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/kkk.png" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>OVO</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;OVO</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>冰蝎、哥斯拉、蚁剑、菜刀流量特征分析</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/10/28
        </span>
        
        <span class="category">
            <a href="/categories/CTF/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                CTF
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/misc/" style="color: #00a596">
                    misc
                </a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <p><del>一个非常非常渣的流量学习（也许</del></p>
<p>最近做了点ctf的题又做了点流量分析，想学习一下这四个常见工具很久了，正好取证题还在下载就来整理一下：）。</p>
<span id="more"></span> 

<p>参考文章（滑跪：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Sgirll/article/details/131860510?sharetype=blogdetail&shareId=131860510&sharerefer=APP&sharesource=2401_87851833&sharefrom=qq">流量特征分析——蚁剑、菜刀、冰蝎、哥斯拉</a>、<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41314882/article/details/147333207?sharetype=blogdetail&shareId=147333207&sharerefer=APP&sharesource=2401_87851833&sharefrom=qq">Webshell管理工具 [流量分析总结文档 蚁剑、冰蝎、菜刀、哥斯拉]</a>、<a target="_blank" rel="noopener" href="https://blog.csdn.net/ai0070411/article/details/146318558?sharetype=blogdetail&shareId=146318558&sharerefer=APP&sharesource=2401_87851833&sharefrom=qq">最新冰蝎，哥斯拉，蚁剑，菜刀流量特征分析与检测指南</a>、<a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_80064376/article/details/140279178?sharetype=blogdetail&shareId=140279178&sharerefer=APP&sharesource=2401_87851833&sharefrom=qq">哥斯拉、冰蝎与蚁剑的流量特征</a>。</p>
<table>
<thead>
<tr>
<th>工具</th>
<th>协议支持</th>
<th>加密方式</th>
<th>核心特点</th>
</tr>
</thead>
<tbody><tr>
<td>冰蝎</td>
<td>HTTP&#x2F;HTTPS、自定义加密协议</td>
<td>AES + 动态密钥交换</td>
<td>全内存加载，无文件落地</td>
</tr>
<tr>
<td>哥斯拉</td>
<td>HTTP&#x2F;HTTPS</td>
<td>XOR + 自定义变种算法</td>
<td>支持多协议插件，流量高度伪装</td>
</tr>
<tr>
<td>蚁剑</td>
<td>HTTP&#x2F;HTTPS</td>
<td>Base64 + 异或</td>
<td>模块化扩展，特征易被修改</td>
</tr>
<tr>
<td>菜刀</td>
<td>HTTP&#x2F;HTTPS、SOCKS5</td>
<td>Base64 明文传输</td>
<td>低版本特征固定，高版本可定制</td>
</tr>
</tbody></table>
<h4 id="1-冰蝎（Behinder）"><a href="#1-冰蝎（Behinder）" class="headerlink" title="1. 冰蝎（Behinder）"></a>1. 冰蝎（Behinder）</h4><p><strong>流量特征</strong>：</p>
<p>主要表现在数据包中的特殊标记和传输的数据类型。冰蝎的数据包中包含了特定的标记，如”flag&#x3D;0x52415631”，用于标识该数据包是冰蝎的控制命令。此外，冰蝎还使用了一种自定义的二进制协议，在通信中传输各种类型的数据。</p>
<h5 id="冰蝎-2-0"><a href="#冰蝎-2-0" class="headerlink" title="冰蝎 2.0"></a>冰蝎 2.0</h5><p>1.使用<strong>AES加密+Base64编码</strong>，AES使用动态密钥对通信进行加密。请求时内置了十几个 User-Agent 头，每次请求时会随机选择其中的一个。因此，当发现一个IP的请求头中的<strong>User-Agent</strong>在频繁变换，就可能是冰蝎。</p>
<p>2.Content-Length:16，16就是冰蝎2连接的特征。</p>
<h5 id="冰蝎-3-0"><a href="#冰蝎-3-0" class="headerlink" title="冰蝎 3.0"></a>冰蝎 3.0</h5><p>1.冰蝎3.0取消了2.0的动态获取密钥，使用固定的连接密钥。AES加密的密钥为webshell连接密码的<strong>MD5的前16位</strong>，默认连接密码是rebeyond​。请求时内置了十几个User-Agent头，每次请求时会随机选择其中的一个。</p>
<p>2.application&#x2F;xhtm1+xmlapplication&#x2F;xmlapplication&#x2F;signed- exchange属于弱特征。</p>
<p>3.jsp抓包特征分析Content-Type: application&#x2F;octet-stream这是一个强特征。查阅资料可知 octet-stream的意思是，只能提交二进制，而且只能提交一个二进制，如果提交文件的话，只能提交一个文件，后台接收参数只能有一个，而且只能是流(或者字节数组)。</p>
<p>4.content-length长度为5720或5740(随Java版本改变)。</p>
<h5 id="冰蝎-4-0"><a href="#冰蝎-4-0" class="headerlink" title="冰蝎 4.0"></a>冰蝎 4.0</h5><p>1.进行请求时内置了十几个 User-Agent 头，每次请求时会随机选择其中的一个。</p>
<p>2.端口为49700左右，每次连接会递增。</p>
<p>3.PHPwebshell存在固定代码。</p>
<p>4.冰蝎通讯默认使用长连接，默认情况下，请求头和响应头里会带有 ​Connection: Keep-Alive​​，这可以作为辅助流量特征。</p>
<p>5.webshell存在默认字符串，为默认连接密码的MD5的前16位。</p>
<p>栗子：</p>
<pre><code class="yaml">POST /api/health HTTP/1.1
Host: target.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
Content-Type: application/json
Accept: application/json
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJ0YXJnZXQuY29tIiwiaWF0IjoxNzA0MjQwMDAwfQ.fake_signature
X-Request-ID: 550e8400-e29b-41d4-a716-446655440000
Content-Length: 156

&#123;
  &quot;component&quot;: &quot;database&quot;,
  &quot;metrics&quot;: &#123;
    &quot;activeConnections&quot;: 15,
    &quot;maxConnections&quot;: 100
  &#125;,
  &quot;checksum&quot;: &quot;kLj8oP3aqY5vT1wXmQ9aZc7rF0gH2jK4lM6nB8vD1iG3kJ5mN7oA9sC0uE2wH4qY6tI8zP0xR3vF5hJ7bL9dO2fQ4iK6aM8cP1eR3gT5jU7&quot;
&#125;
</code></pre>
<p>base64+AES解密后：</p>
<pre><code class="yaml">&#123;
  &quot;type&quot;: &quot;cmd&quot;,
  &quot;cmd&quot;: &quot;whoami&quot;,
  &quot;path&quot;: &quot;C:\\\\&quot;,
  &quot;session&quot;: &quot;7d4f3e2a-1b8c-4a9d-8e7f-6c5d4e3f2a1b&quot;
&#125;
</code></pre>
<h4 id="2-哥斯拉（Godzilla）"><a href="#2-哥斯拉（Godzilla）" class="headerlink" title="2.哥斯拉（Godzilla）"></a>2.哥斯拉（Godzilla）</h4><p><strong>流量特征：</strong></p>
<p>1.流量特征主要表现在<strong>数据包的特殊标记和数据类型</strong>。哥斯拉的数据包中包含了特定的标记，如”XORHEAD”和”XORBODY”，用于标识该数据包是哥斯拉的控制命令。此外，哥斯拉还使用了一种自定义的二进制协议，在通信中传输各种类型的数据。</p>
<p>2.Cookie字段中存在一个关键的特征，即<strong>最后一个Cookie值的末尾有一个不必要的分号</strong>，在标准的HTTP请求中，最后一个Cookie的值后面不应该出现分号。</p>
<p>3.<strong>响应包结构特征</strong>:MD5前16位+base64+MD5后16位</p>
<p>栗子：</p>
<pre><code class="yaml">POST /upload/images/template.jsp HTTP/1.1
Host: target-company.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Accept-Encoding: gzip, deflate
Connection: keep-alive
Cache-Control: max-age=0
Content-Type: application/x-www-form-urlencoded
Cookie: JSESSIONID=AC9C9335F0B8421D8E392B314C3A1F32;
Upgrade-Insecure-Requests: 1
Content-Length: 342

payload=UEsDBBQACAAIAFNlc2UAAAAAAAAAAAAAAAAZAAAAemV1cy5qc3Atsk1OwzAQhfc5xSxYtKJqF0gI
CSEhVl0gxMLE4ySOGttl7CkK5+4MpUVCLFjYfs+b92Y8T3hVpVJ8o1uTQ4YhxQhD8tC1XW9tD0mK
McWYfPZ9Z3sHKYUUQ4ohhRBC8tC1XW9tD0mKMcWYfPZ9Z3sHKYUUQ4ohhRBC8tC1XW9tD0mKMcWY
...
</code></pre>
<p><strong>识别方法</strong>：关注数据包的特殊标记和数据类型；关注cookie值和响应包特征。</p>
<h4 id="3-蚁剑（AntSword）"><a href="#3-蚁剑（AntSword）" class="headerlink" title="3.蚁剑（AntSword）"></a>3.蚁剑（AntSword）</h4><p><strong>流量特征：</strong></p>
<p>1.<strong>Header</strong>：默认 User-Agent: AntSword&#x2F;v2.1（可修改，但低权限用户可能保留）。</p>
<p>2.在默认使用base64编码器的情况下，其流量虽然编码，但<strong>存在固定的起始和结束标记</strong>。</p>
<p>例如，Payload通常以**@ini_set(…);@set_time_limit(0);…**开头，经过Base64编码后，其开头部分（如 QGluaV9zZXQo…）相对固定，可以成为检测特征。</p>
<p>3.响应特征：响应为文件列表或命令输出。</p>
<p>栗子：</p>
<pre><code class="yaml">POST /vendor/phpunit/autoload.php HTTP/1.1
Host: target.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Content-Type: application/x-www-form-urlencoded
Content-Length: 892
Connection: close

_0x5c3d=%40%69%6e%69%5f%73%65%74%28%22%64%69%73%70%6c%61%79%5f%65%72%72%6f%72%73%22%2c%22%30%22%29%3b%40%73%65%74%5f%74%69%6d%65%5f%6c%69%6d%69%74%28%30%29%3b%66%75%6e%63%74%69%6f%6e%20%61%73%32%6e%64%65%33%28%24%63%29%7b%24%72%65%3d%22%22%3b%66%6f%72%28%24%69%3d%30%3b%24%69%3c%73%74%72%6c%65%6e%28%24%63%29%3b%24%69%2b%2b%29%7b%24%72%65%2e%3d%63%68%72%28%6f%72%64%28%24%63%7b%24%69%7d%29%2d%31%29%3b%7d%72%65%74%75%72%6e%20%24%72%65%3b%7d%65%76%61%6c%28%61%73%32%6e%64%65%33%28%62%61%73%65%36%34%5f%64%65%63%6f%64%65%28%27%4c%32%74%6a%62%59%57%78%6c%63%6d%56%7a%64%48%4a%70%59%32%56%6a%61%32%56%30%4c%6d%35%6c%64%47%56%79%64%58%56%75%58%33%42%68%62%6d%52%68%62%6d%64%6c%58%32%35%68%62%57%55%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%69%4f%69%49%79%4c%6d%64%76%62%32%64%73%5a%53%35%6a%62%32%30%27%29%29%29%3b
</code></pre>
<p>解码后：</p>
<pre><code class="yaml">@ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);function as2nde3($c)&#123;$re=&quot;&quot;;for($i=0;$i&lt;strlen($c);$i++)&#123;$re.=chr(ord($c&#123;$i&#125;)-1);&#125;return $re;&#125;eval(as2nde3(base64_decode(&#39;L2tjb...（非常长的Base64字符串）&#39;)));
</code></pre>
<p><strong>识别方法</strong>：检测 _0x 开头的参数名；检测请求中的固定开头 @ini_set(“display_errors”,”0”);@set_time_limit(0)。</p>
<h4 id="4-菜刀（ChinaChopper）"><a href="#4-菜刀（ChinaChopper）" class="headerlink" title="4.菜刀（ChinaChopper）"></a>4.菜刀（ChinaChopper）</h4><p><strong>流量特征：</strong></p>
<p>1.<strong>Header</strong>：Accept: text&#x2F;html, image&#x2F;gif, image&#x2F;jpeg, *; q&#x3D;.2, <em>&#x2F;</em>; q&#x3D;.2</p>
<p>2.<strong>Body</strong>：eval(base64_decode($_POST[‘z0’])) 结构，参数名固定（如z0，z1，pass，cmd 等）。</p>
<p>3.<strong>URL</strong>：路径简短（如 &#x2F;admin.php），参数值长度固定为 16 倍数。</p>
<p>4.<strong>User-Agent</strong>： 早期版本有固定的User-Agent，如 Mozilla&#x2F;4.0 (compatible; MSIE 6.0; Windows NT 5.1)。</p>
<p><strong>WAF检测关键词</strong>：<br>eval(base64_decode(， $_POST[‘z0’]， assert(， ExecuteGlobal。</p>
<p>栗子：</p>
<pre><code class="yaml">POST /shell.php HTTP/1.1
Host: victim.com
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
Content-Type: application/x-www-form-urlencoded
Content-Length: 125

z0=QGV2YWwoYmFzZTY0X2RlY29kZSgkX1BPU1RbJ3oxJ10pKTs=&amp;z1=system(&#39;whoami&#39;)
</code></pre>
<p>其中参数z0的值QGV2YWwoYmFzZTY0X…是Base64编码。解码后内容为：@eval(base64_decode($_POST[‘z1’]));。</p>
<p><strong>识别方法</strong>：监控POST请求中的敏感关键字或base64编码。</p>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2025 OvO
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;你猜不到的
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
        <div>
            备案号：
            
            
            
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    




    
</body>
</html>
